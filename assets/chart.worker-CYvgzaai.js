(function(){"use strict";var B={},j;function fr(){if(j)return B;j=1,Object.defineProperty(B,"__esModule",{value:!0});function y(r){if(Array.isArray(r))return r}function D(r,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var t=[],a=!0,n=!1,f=void 0;try{for(var o=r[Symbol.iterator](),v;!(a=(v=o.next()).done)&&(t.push(v.value),!(e&&t.length===e));a=!0);}catch(l){n=!0,f=l}finally{try{!a&&o.return!=null&&o.return()}finally{if(n)throw f}}return t}}function A(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function P(r,e){if(r){if(typeof r=="string")return A(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return A(r,e)}}function E(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m(r,e){return y(r)||D(r,e)||P(r,e)||E()}var i={"PointValueExtractor<unknown>":r=>typeof r=="function",XYDataPoint:r=>r!=null&&i.X(r.x)&&typeof r.y=="number",X:r=>typeof r=="number"||r instanceof Date};function I(r,e,t){return Math.abs((r[0]-t[0])*(e[1]-r[1])-(r[0]-e[0])*(t[1]-r[1]))/2}function X(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var a=e.length;if(a){for(var n=0,f=0,o=0;o<a;o++)n+=e[o][0],f+=e[o][1];return[n/a,f/a]}}function R(r,e){if(r.length===2)return[[r[0]],[r[1]]];for(var t=r[0],a=r.slice(1,r.length-1),n=r[r.length-1],f=a.length/(e-2),o=[[t]],v=0;v<e-2;v++){var l=Math.floor(v*f),c=Math.floor((v+1)*f),u=a.slice(l,c);o.push(u)}return o.push([n]),o}var U=r=>{for(var e=0,t=0;t<r.length;t+=1)e+=r[t];return e/r.length},q=r=>{for(var e=U(r),t=0,a=0;a<r.length;a+=1)t+=(r[a]-e)*(r[a]-e);return Math.sqrt(t/r.length)},F=(r,e)=>{for(var t=r.length,a=new Array(t),n=0;n<t;n++)a[n]=e(r[n],n);return a},C=r=>i["PointValueExtractor<unknown>"](r)?r:e=>e[r],s=(r,e)=>{var t=C(r),a=C(e);return n=>F(n,(f,o)=>[t(f,o),a(f,o)])},d=(r,e)=>({x:r,y:e}),b=()=>({x:r=>{var e=i.XYDataPoint(r)?r.x:r[0];return e instanceof Date?e.getTime():e},y:r=>"y"in r?r.y:r[1],toPoint:d}),O=(r,e)=>new r.constructor(e),L=function(e,t){for(var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=[],f=0,o=0;o<t;o++)f+=e[o];for(var v=t;v<=e.length;v++)(v-t)%a===0&&n.push(f/t),f+=e[v]-e[v-t];return n},$=r=>{var e=C(r.x),t=C(r.y),a=r.toPoint;return function(n,f){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(n.length===0)return n;for(var v=F(n,t),l=F(n,e),c=O(n,0),u=0,g,h=0;h<f;h++)u+=v[h];for(var T=f;T<=v.length;T++)(T-f)%o===0&&(g=a((l[T-f]+l[T-1])/2,u/f,T-f),c[c.length]=g),u+=v[T]-v[T-f];return c}},K=$(b());function G(r,e){if(r.length!=e.length)throw"Mismatched lengths";var t=r.length;t!=0&&((t&t-1)==0?H(r,e):hr(r,e))}function Y(r,e){G(e,r)}function H(r,e){if(r.length!=e.length)throw"Mismatched lengths";var t=r.length;if(t!=1){for(var a=-1,n=0;n<32;n++)1<<n==t&&(a=n);if(a==-1)throw"Length is not a power of 2";for(var f=new Array(t/2),o=new Array(t/2),v=0;v<t/2;v++)f[v]=Math.cos(2*Math.PI*v/t),o[v]=Math.sin(2*Math.PI*v/t);for(var l=0;l<t;l++){var c=V(l,a);if(c>l){var u=r[l];r[l]=r[c],r[c]=u,u=e[l],e[l]=e[c],e[c]=u}}for(var g=2;g<=t;g*=2)for(var h=g/2,T=t/g,p=0;p<t;p+=g)for(var M=p,w=0;M<p+h;M++,w+=T){var N=r[M+h]*f[w]+e[M+h]*o[w],S=-r[M+h]*o[w]+e[M+h]*f[w];r[M+h]=r[M]-N,e[M+h]=e[M]-S,r[M]+=N,e[M]+=S}}}function V(r,e){for(var t=0,a=0;a<e;a++)t=t<<1|r&1,r>>>=1;return t}function hr(r,e){if(r.length!=e.length)throw"Mismatched lengths";for(var t=r.length,a=1;a<t*2+1;)a*=2;for(var n=new Array(t),f=new Array(t),o=0;o<t;o++){var v=o*o%(t*2);n[o]=Math.cos(Math.PI*v/t),f[o]=Math.sin(Math.PI*v/t)}for(var l=new Array(a),c=new Array(a),u=0;u<t;u++)l[u]=r[u]*n[u]+e[u]*f[u],c[u]=-r[u]*f[u]+e[u]*n[u];for(var g=t;g<a;g++)l[g]=c[g]=0;var h=new Array(a),T=new Array(a);h[0]=n[0],T[0]=f[0];for(var p=1;p<t;p++)h[p]=h[a-p]=n[p],T[p]=T[a-p]=f[p];for(var M=t;M<=a-t;M++)h[M]=T[M]=0;var w=new Array(a),N=new Array(a);sr(l,c,h,T,w,N);for(var S=0;S<t;S++)r[S]=w[S]*n[S]+N[S]*f[S],e[S]=-w[S]*f[S]+N[S]*n[S]}function sr(r,e,t,a,n,f){if(r.length!=e.length||r.length!=t.length||t.length!=a.length||r.length!=n.length||n.length!=f.length)throw"Mismatched lengths";var o=r.length;r=r.slice(),e=e.slice(),t=t.slice(),a=a.slice(),G(r,e),G(t,a);for(var v=0;v<o;v++){var l=r[v]*t[v]-e[v]*a[v];e[v]=e[v]*t[v]+r[v]*a[v],r[v]=l}Y(r,e);for(var c=0;c<o;c++)n[c]=r[c]/o,f[c]=e[c]/o}var gr=r=>{var e=r.length-1;if(e<1)return[];for(var t=new Array(e),a=0;a<e;a++)t[a]=r[a+1]-r[a];return t},W=r=>q(gr(r)),J=r=>{for(var e=r.length,t=U(r),a=0,n=0,f,o,v=0;v<e;v++)f=r[v]-t,o=f*f,a+=o*o,n+=o;return e*a/(n*n)},pr=(r,e,t,a,n,f)=>{for(;r<=e;){var o=Math.round((r+e)/2),v=L(t,o,1),l=J(v);if(l>=n){var c=W(v);c<a&&(f=o,a=c),r=o+1}else e=o-1}return f},Tr=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.2,a=e.length;if(a<=1)return[[],0];var n=0,f=[];if(e.length>1)for(var o=e[1]>e[0],v=1,l=2;l<e.length;l+=1)!o&&e[l]>e[l-1]?(v=l,o=!o):o&&e[l]>e[v]?v=l:o&&e[l]<e[l-1]&&(v>1&&e[v]>t&&(f.push(v),e[v]>n&&(n=e[v])),o=!o);if(f.length<=1)for(var c=2;c<a;c+=1)f.push(c);return[f,n]},Mr=(r,e)=>{for(var t=r.length,a=U(r),n=Math.pow(2,Math.trunc(Math.log2(t))+1),f=new Array(n).fill(0),o=new Array(n).fill(0),v=0;v<t;v+=1)f[v]=r[v]-a;G(f,o);for(var l=0;l<f.length;l+=1)f[l]=Math.pow(f[l],2)+Math.pow(o[l],2),o[l]=0;Y(f,o);for(var c=[],u=1;u<e;u++)c[u]=f[u]/f[0];var g=Tr(c),h=m(g,2),T=h[0],p=h[1];return{correlations:c,peaks:T,maxCorrelation:p}},Q=r=>{var e=C(r.y),t=$(r);return function a(n,f){if(n.length===0)return n;if(f<=0)throw new Error("Supplied non-positive resolution parameter to ASAP: ".concat(f));if(n.length>=2*f){var o=Math.trunc(n.length/f);return a(t(n,o,o),f)}for(var v=F(n,e),l=Mr(v,Math.round(v.length/10)),c=l.correlations,u=l.peaks,g=l.maxCorrelation,h=J(v),T=W(v),p=1,M=1,w=-1,N=v.length/10,S=u.length-1;S>=0;S-=1){var k=u[S];if(k<M||k===1)break;if(Math.sqrt(1-c[k])*p>Math.sqrt(1-c[p])*k)continue;var or=L(v,k,1),br=J(or),vr=W(or);br>=h&&(vr<T&&(T=vr,p=k),M=Math.round(Math.max(k*Math.sqrt((g-1)/(c[k]-1)),M)),w<0&&(w=S))}return w>0&&(w<u.length-2&&(N=u[w+1]),M=Math.max(M,u[w]+1)),p=pr(M,N,v,T,h,p),t(n,p,1)}},rr=Q(b());function tr(r){for(var e=r.length,t=[0],a=1,n=r[0][0],f=1;f<e-1;f++){var o=r[f],v=r[f+1],l=X(...v);if(l!==void 0){for(var c=-1,u=-1,g=0;g<o.length;g++){var h=o[g],T=I(n,h,l);T>c&&(c=T,u=g)}n=o[u],t.push(a+u),a+=o.length}}return t.push(a),t}var Z=r=>{var e=s(r.x,r.y);return(t,a)=>{if(a<0)throw new Error("Supplied negative desiredLength parameter to LTTB: ".concat(a));var n=t.length;if(n<=1||n<=a)return t;for(var f=e(t),o=R(f,a),v=tr(o),l=O(t,v.length),c=0;c<v.length;c++)l[c]=t[v[c]];return l}},er=Z(b()),mr=(r,e)=>{var t=r[e],a=r[e+1];if(!t||!a)throw new Error("Bucket index out of range for merging: ".concat(e," (allowed indexes are 0 - ").concat(r.length-2));var n=[...t,...a],f=r.slice();return f.splice(e,2,n),f},Ar=(r,e)=>{var t=r[e];if(!t)throw new Error("Bucket index out of range for splitting: ".concat(e," (allowed indexes are 0 - ").concat(r.length-1));var a=t.length;if(a<2)return r;var n=Math.ceil(a/2),f=t.slice(0,n),o=t.slice(n),v=r.slice();return v.splice(e,1,f,o),v},yr=r=>{for(var e=r.length,t=0,a=0,n=0;n<e;n++)t+=r[n][0],a+=r[n][1];t/=e,a/=e;for(var f=0,o=0,v=0;v<e;v++){var l=m(r[v],2),c=l[0],u=l[1];f+=(c-t)*(u-a),o+=(c-t)*(c-t)}var g=f/o,h=a-g*t;return[g,h]},Sr=r=>{for(var e=yr(r),t=m(e,2),a=t[0],n=t[1],f=0,o=0;o<r.length;o++){var v=r[o],l=v[1]-(a*v[0]+n);f+=l*l}return f},Dr=r=>{for(var e=[0],t=1;t<r.length-1;t++){var a=r[t-1],n=r[t],f=r[t+1],o=[a[a.length-1],...n,f[0]];e.push(Sr(o))}return e.push(0),e},ir=(r,e)=>{for(var t=Number.MAX_VALUE,a=void 0,n=1;n<r.length-2;n++)n===e||n+1===e||r[n]+r[n+1]<t&&(t=r[n]+r[n+1],a=n);return a},Pr=(r,e)=>{for(var t=0,a=void 0,n=1;n<e.length-1;n++)r[n].length>1&&e[n]>t&&(t=e[n],a=n);return a},x=r=>{var e=s(r.x,r.y);return(t,a)=>{if(a<0)throw new Error("Supplied negative desiredLength parameter to LTD: ".concat(a));var n=t.length;if(n<=2||n<=a)return t;for(var f=e(t),o=R(f,a),v=n*10/a,l=0;l<v;l++){var c=Dr(o),u=Pr(o,c);if(u===void 0)break;var g=ir(c,u);if(g===void 0)break;o=Ar(o,u),o=mr(o,g>u?g+1:g)}for(var h=tr(o),T=h.length,p=O(t,T),M=0;M<T;M++)p[M]=t[h[M]];return p}},ar=x(b()),z=r=>{var e=s(r.x,r.y);return(t,a)=>{if(a<0)throw new Error("Supplied negative desiredLength parameter to LTOB: ".concat(a));var n=t.length;if(n<=1||n<=a)return t;var f=n/a,o=e(t),v=Math.max(2,a),l=O(t,v);l[0]=t[0],l[v-1]=t[n-1];for(var c=1;c<a-1;c++){for(var u=Math.floor(c*f),g=Math.min(n-1,(c+1)*f),h=-1,T=-1,p=u;p<g;p++){var M=o[p-1],w=o[p],N=o[p+1],S=I(M,w,N);S>h&&(h=S,T=p)}l[c]=t[T]}return l}},nr=z(b()),wr={ASAP:rr,LTD:ar,LTOB:nr,LTTB:er,SMA:K,createASAP:Q,createLTD:x,createLTOB:z,createLTTB:Z,createSMA:$};return B.ASAP=rr,B.LTD=ar,B.LTOB=nr,B.LTTB=er,B.SMA=K,B.createASAP=Q,B.createLTD=x,B.createLTOB=z,B.createLTTB=Z,B.createSMA=$,B.default=wr,B}var lr=fr();const _=(y,D)=>{y.sort((A,P)=>A[D]-P[D])},cr=(y,D,A)=>{let P=0,E=y.length-1,m=0,i=1/0;if(y.length===0)return-1;const I=y[P]?.[A]??-1/0,X=y[E]?.[A]??1/0;if(D<=I)return P;if(D>=X)return E;for(;P<=E;){const R=Math.floor((P+E)/2),U=y[R]?.[A]??0,q=Math.abs(U-D);if(q<i&&(i=q,m=R),U<D)P=R+1;else if(U>D)E=R-1;else return R}return m>0&&Math.abs((y[m-1]?.[A]??0)-D)<i&&(m=m-1,i=Math.abs((y[m]?.[A]??0)-D)),m<y.length-1&&Math.abs((y[m+1]?.[A]??0)-D)<i&&(m=m+1),m},ur=(y,D,A,P)=>{if(y.length<=P)return y;if(A)try{const E=y.map((I,X)=>({originalData:I,index:X,x:I[D],y:I[A]??0}));return lr.LTTB(E,P).map(I=>I.originalData)}catch(E){console.error("LTTB Downsampling failed in worker:",E);const m=Math.ceil(y.length/P);return y.filter((i,I)=>I%m===0)}else{const E=Math.ceil(y.length/P);return y.filter((m,i)=>i%E===0)}};self.onmessage=y=>{if(y.data.type==="PROCESS_DATA"){const{activeRuns:D,xAxisKey:A,selectedMetricKeys:P,downsampleThreshold:E}=y.data.payload;try{if(D.length===0){self.postMessage({type:"DATA_READY",payload:{labels:[],datasets:{},fullDataForDetails:[]}});return}D.forEach(s=>{s.performanceLogs&&_(s.performanceLogs,A)});const m=s=>{if(!s.performanceLogs||s.performanceLogs.length===0)return-1/0;const b=s.performanceLogs[s.performanceLogs.length-1][A];return typeof b=="number"&&!isNaN(b)?b:-1/0},i=D.reduce((s,d)=>m(s)>m(d)?s:d),I=D.filter(s=>s.id!==i.id),X=new Map;I.forEach(s=>{X.set(s.id,m(s))});const R=[];i.performanceLogs.forEach(s=>{const d={TIMESTAMP:s.TIMESTAMP,[A]:s[A]},b=i.id;d[`${b}:TIMESTAMP`]=s.TIMESTAMP,i.availableMetrics.forEach(L=>{const $=L.key;s[$]!==void 0&&(d[`${b}:${$}`]=s[$])}),s.BURST_LOGGING_STATUS!==void 0&&(d[`${b}:BURST_LOGGING_STATUS`]=s.BURST_LOGGING_STATUS);const O=s[A];isNaN(O)||(I.forEach(L=>{if(!L.performanceLogs||L.performanceLogs.length===0)return;const $=X.get(L.id)??-1/0;if(O>$)return;const K=cr(L.performanceLogs,O,A);if(K!==-1){const G=L.performanceLogs[K],Y=L.id;L.availableMetrics.forEach(H=>{const V=H.key;G[V]!==void 0&&(d[`${Y}:${V}`]=G[V])}),G.BURST_LOGGING_STATUS!==void 0&&(d[`${Y}:BURST_LOGGING_STATUS`]=G.BURST_LOGGING_STATUS),G.TIMESTAMP!==void 0&&(d[`${Y}:TIMESTAMP`]=G.TIMESTAMP)}}),R.push(d))}),_(R,A);let U;P.length>0&&(U=`${i.id}:${P[0]}`);const q=ur(R,A,U,E),F=q.map(s=>s[A]),C={};D.forEach(s=>{P.forEach(d=>{const b=`${s.id}:${d}`;C[b]=q.map(O=>{const L=O[b];return{x:O[A],y:typeof L=="number"?L:null}})})}),self.postMessage({type:"DATA_READY",payload:{labels:F,datasets:C,fullDataForDetails:R}})}catch(m){console.error("Error processing chart data in worker:",m),self.postMessage({type:"ERROR",payload:{message:m.message||"Unknown worker error"}})}}}})();

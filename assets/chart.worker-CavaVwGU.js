(function(){"use strict";var B={},j;function fr(){if(j)return B;j=1,Object.defineProperty(B,"__esModule",{value:!0});function S(r){if(Array.isArray(r))return r}function D(r,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var t=[],a=!0,n=!1,f=void 0;try{for(var o=r[Symbol.iterator](),v;!(a=(v=o.next()).done)&&(t.push(v.value),!(e&&t.length===e));a=!0);}catch(l){n=!0,f=l}finally{try{!a&&o.return!=null&&o.return()}finally{if(n)throw f}}return t}}function A(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function E(r,e){if(r){if(typeof r=="string")return A(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return A(r,e)}}function I(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m(r,e){return S(r)||D(r,e)||E(r,e)||I()}var P={"PointValueExtractor<unknown>":r=>typeof r=="function",XYDataPoint:r=>r!=null&&P.X(r.x)&&typeof r.y=="number",X:r=>typeof r=="number"||r instanceof Date};function i(r,e,t){return Math.abs((r[0]-t[0])*(e[1]-r[1])-(r[0]-e[0])*(t[1]-r[1]))/2}function U(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var a=e.length;if(a){for(var n=0,f=0,o=0;o<a;o++)n+=e[o][0],f+=e[o][1];return[n/a,f/a]}}function R(r,e){if(r.length===2)return[[r[0]],[r[1]]];for(var t=r[0],a=r.slice(1,r.length-1),n=r[r.length-1],f=a.length/(e-2),o=[[t]],v=0;v<e-2;v++){var l=Math.floor(v*f),u=Math.floor((v+1)*f),c=a.slice(l,u);o.push(c)}return o.push([n]),o}var $=r=>{for(var e=0,t=0;t<r.length;t+=1)e+=r[t];return e/r.length},q=r=>{for(var e=$(r),t=0,a=0;a<r.length;a+=1)t+=(r[a]-e)*(r[a]-e);return Math.sqrt(t/r.length)},F=(r,e)=>{for(var t=r.length,a=new Array(t),n=0;n<t;n++)a[n]=e(r[n],n);return a},C=r=>P["PointValueExtractor<unknown>"](r)?r:e=>e[r],h=(r,e)=>{var t=C(r),a=C(e);return n=>F(n,(f,o)=>[t(f,o),a(f,o)])},b=(r,e)=>({x:r,y:e}),L=()=>({x:r=>{var e=P.XYDataPoint(r)?r.x:r[0];return e instanceof Date?e.getTime():e},y:r=>"y"in r?r.y:r[1],toPoint:b}),O=(r,e)=>new r.constructor(e),d=function(e,t){for(var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=[],f=0,o=0;o<t;o++)f+=e[o];for(var v=t;v<=e.length;v++)(v-t)%a===0&&n.push(f/t),f+=e[v]-e[v-t];return n},k=r=>{var e=C(r.x),t=C(r.y),a=r.toPoint;return function(n,f){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(n.length===0)return n;for(var v=F(n,t),l=F(n,e),u=O(n,0),c=0,g,s=0;s<f;s++)c+=v[s];for(var M=f;M<=v.length;M++)(M-f)%o===0&&(g=a((l[M-f]+l[M-1])/2,c/f,M-f),u[u.length]=g),c+=v[M]-v[M-f];return u}},K=k(L());function N(r,e){if(r.length!=e.length)throw"Mismatched lengths";var t=r.length;t!=0&&((t&t-1)==0?H(r,e):hr(r,e))}function Y(r,e){N(e,r)}function H(r,e){if(r.length!=e.length)throw"Mismatched lengths";var t=r.length;if(t!=1){for(var a=-1,n=0;n<32;n++)1<<n==t&&(a=n);if(a==-1)throw"Length is not a power of 2";for(var f=new Array(t/2),o=new Array(t/2),v=0;v<t/2;v++)f[v]=Math.cos(2*Math.PI*v/t),o[v]=Math.sin(2*Math.PI*v/t);for(var l=0;l<t;l++){var u=V(l,a);if(u>l){var c=r[l];r[l]=r[u],r[u]=c,c=e[l],e[l]=e[u],e[u]=c}}for(var g=2;g<=t;g*=2)for(var s=g/2,M=t/g,p=0;p<t;p+=g)for(var T=p,w=0;T<p+s;T++,w+=M){var G=r[T+s]*f[w]+e[T+s]*o[w],y=-r[T+s]*o[w]+e[T+s]*f[w];r[T+s]=r[T]-G,e[T+s]=e[T]-y,r[T]+=G,e[T]+=y}}}function V(r,e){for(var t=0,a=0;a<e;a++)t=t<<1|r&1,r>>>=1;return t}function hr(r,e){if(r.length!=e.length)throw"Mismatched lengths";for(var t=r.length,a=1;a<t*2+1;)a*=2;for(var n=new Array(t),f=new Array(t),o=0;o<t;o++){var v=o*o%(t*2);n[o]=Math.cos(Math.PI*v/t),f[o]=Math.sin(Math.PI*v/t)}for(var l=new Array(a),u=new Array(a),c=0;c<t;c++)l[c]=r[c]*n[c]+e[c]*f[c],u[c]=-r[c]*f[c]+e[c]*n[c];for(var g=t;g<a;g++)l[g]=u[g]=0;var s=new Array(a),M=new Array(a);s[0]=n[0],M[0]=f[0];for(var p=1;p<t;p++)s[p]=s[a-p]=n[p],M[p]=M[a-p]=f[p];for(var T=t;T<=a-t;T++)s[T]=M[T]=0;var w=new Array(a),G=new Array(a);sr(l,u,s,M,w,G);for(var y=0;y<t;y++)r[y]=w[y]*n[y]+G[y]*f[y],e[y]=-w[y]*f[y]+G[y]*n[y]}function sr(r,e,t,a,n,f){if(r.length!=e.length||r.length!=t.length||t.length!=a.length||r.length!=n.length||n.length!=f.length)throw"Mismatched lengths";var o=r.length;r=r.slice(),e=e.slice(),t=t.slice(),a=a.slice(),N(r,e),N(t,a);for(var v=0;v<o;v++){var l=r[v]*t[v]-e[v]*a[v];e[v]=e[v]*t[v]+r[v]*a[v],r[v]=l}Y(r,e);for(var u=0;u<o;u++)n[u]=r[u]/o,f[u]=e[u]/o}var gr=r=>{var e=r.length-1;if(e<1)return[];for(var t=new Array(e),a=0;a<e;a++)t[a]=r[a+1]-r[a];return t},W=r=>q(gr(r)),J=r=>{for(var e=r.length,t=$(r),a=0,n=0,f,o,v=0;v<e;v++)f=r[v]-t,o=f*f,a+=o*o,n+=o;return e*a/(n*n)},pr=(r,e,t,a,n,f)=>{for(;r<=e;){var o=Math.round((r+e)/2),v=d(t,o,1),l=J(v);if(l>=n){var u=W(v);u<a&&(f=o,a=u),r=o+1}else e=o-1}return f},Mr=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.2,a=e.length;if(a<=1)return[[],0];var n=0,f=[];if(e.length>1)for(var o=e[1]>e[0],v=1,l=2;l<e.length;l+=1)!o&&e[l]>e[l-1]?(v=l,o=!o):o&&e[l]>e[v]?v=l:o&&e[l]<e[l-1]&&(v>1&&e[v]>t&&(f.push(v),e[v]>n&&(n=e[v])),o=!o);if(f.length<=1)for(var u=2;u<a;u+=1)f.push(u);return[f,n]},Tr=(r,e)=>{for(var t=r.length,a=$(r),n=Math.pow(2,Math.trunc(Math.log2(t))+1),f=new Array(n).fill(0),o=new Array(n).fill(0),v=0;v<t;v+=1)f[v]=r[v]-a;N(f,o);for(var l=0;l<f.length;l+=1)f[l]=Math.pow(f[l],2)+Math.pow(o[l],2),o[l]=0;Y(f,o);for(var u=[],c=1;c<e;c++)u[c]=f[c]/f[0];var g=Mr(u),s=m(g,2),M=s[0],p=s[1];return{correlations:u,peaks:M,maxCorrelation:p}},Q=r=>{var e=C(r.y),t=k(r);return function a(n,f){if(n.length===0)return n;if(f<=0)throw new Error("Supplied non-positive resolution parameter to ASAP: ".concat(f));if(n.length>=2*f){var o=Math.trunc(n.length/f);return a(t(n,o,o),f)}for(var v=F(n,e),l=Tr(v,Math.round(v.length/10)),u=l.correlations,c=l.peaks,g=l.maxCorrelation,s=J(v),M=W(v),p=1,T=1,w=-1,G=v.length/10,y=c.length-1;y>=0;y-=1){var X=c[y];if(X<T||X===1)break;if(Math.sqrt(1-u[X])*p>Math.sqrt(1-u[p])*X)continue;var or=d(v,X,1),wr=J(or),vr=W(or);wr>=s&&(vr<M&&(M=vr,p=X),T=Math.round(Math.max(X*Math.sqrt((g-1)/(u[X]-1)),T)),w<0&&(w=y))}return w>0&&(w<c.length-2&&(G=c[w+1]),T=Math.max(T,c[w]+1)),p=pr(T,G,v,M,s,p),t(n,p,1)}},rr=Q(L());function tr(r){for(var e=r.length,t=[0],a=1,n=r[0][0],f=1;f<e-1;f++){var o=r[f],v=r[f+1],l=U(...v);if(l!==void 0){for(var u=-1,c=-1,g=0;g<o.length;g++){var s=o[g],M=i(n,s,l);M>u&&(u=M,c=g)}n=o[c],t.push(a+c),a+=o.length}}return t.push(a),t}var Z=r=>{var e=h(r.x,r.y);return(t,a)=>{if(a<0)throw new Error("Supplied negative desiredLength parameter to LTTB: ".concat(a));var n=t.length;if(n<=1||n<=a)return t;for(var f=e(t),o=R(f,a),v=tr(o),l=O(t,v.length),u=0;u<v.length;u++)l[u]=t[v[u]];return l}},er=Z(L()),mr=(r,e)=>{var t=r[e],a=r[e+1];if(!t||!a)throw new Error("Bucket index out of range for merging: ".concat(e," (allowed indexes are 0 - ").concat(r.length-2));var n=[...t,...a],f=r.slice();return f.splice(e,2,n),f},Ar=(r,e)=>{var t=r[e];if(!t)throw new Error("Bucket index out of range for splitting: ".concat(e," (allowed indexes are 0 - ").concat(r.length-1));var a=t.length;if(a<2)return r;var n=Math.ceil(a/2),f=t.slice(0,n),o=t.slice(n),v=r.slice();return v.splice(e,1,f,o),v},Sr=r=>{for(var e=r.length,t=0,a=0,n=0;n<e;n++)t+=r[n][0],a+=r[n][1];t/=e,a/=e;for(var f=0,o=0,v=0;v<e;v++){var l=m(r[v],2),u=l[0],c=l[1];f+=(u-t)*(c-a),o+=(u-t)*(u-t)}var g=f/o,s=a-g*t;return[g,s]},yr=r=>{for(var e=Sr(r),t=m(e,2),a=t[0],n=t[1],f=0,o=0;o<r.length;o++){var v=r[o],l=v[1]-(a*v[0]+n);f+=l*l}return f},Dr=r=>{for(var e=[0],t=1;t<r.length-1;t++){var a=r[t-1],n=r[t],f=r[t+1],o=[a[a.length-1],...n,f[0]];e.push(yr(o))}return e.push(0),e},Pr=(r,e)=>{for(var t=Number.MAX_VALUE,a=void 0,n=1;n<r.length-2;n++)n===e||n+1===e||r[n]+r[n+1]<t&&(t=r[n]+r[n+1],a=n);return a},Er=(r,e)=>{for(var t=0,a=void 0,n=1;n<e.length-1;n++)r[n].length>1&&e[n]>t&&(t=e[n],a=n);return a},x=r=>{var e=h(r.x,r.y);return(t,a)=>{if(a<0)throw new Error("Supplied negative desiredLength parameter to LTD: ".concat(a));var n=t.length;if(n<=2||n<=a)return t;for(var f=e(t),o=R(f,a),v=n*10/a,l=0;l<v;l++){var u=Dr(o),c=Er(o,u);if(c===void 0)break;var g=Pr(u,c);if(g===void 0)break;o=Ar(o,c),o=mr(o,g>c?g+1:g)}for(var s=tr(o),M=s.length,p=O(t,M),T=0;T<M;T++)p[T]=t[s[T]];return p}},ar=x(L()),z=r=>{var e=h(r.x,r.y);return(t,a)=>{if(a<0)throw new Error("Supplied negative desiredLength parameter to LTOB: ".concat(a));var n=t.length;if(n<=1||n<=a)return t;var f=n/a,o=e(t),v=Math.max(2,a),l=O(t,v);l[0]=t[0],l[v-1]=t[n-1];for(var u=1;u<a-1;u++){for(var c=Math.floor(u*f),g=Math.min(n-1,(u+1)*f),s=-1,M=-1,p=c;p<g;p++){var T=o[p-1],w=o[p],G=o[p+1],y=i(T,w,G);y>s&&(s=y,M=p)}l[u]=t[M]}return l}},nr=z(L()),Lr={ASAP:rr,LTD:ar,LTOB:nr,LTTB:er,SMA:K,createASAP:Q,createLTD:x,createLTOB:z,createLTTB:Z,createSMA:k};return B.ASAP=rr,B.LTD=ar,B.LTOB=nr,B.LTTB=er,B.SMA=K,B.createASAP=Q,B.createLTD=x,B.createLTOB=z,B.createLTTB=Z,B.createSMA=k,B.default=Lr,B}var lr=fr();const ur=(S,D,A)=>{let E=0,I=S.length-1,m=0,P=1/0;if(S.length===0)return-1;const i=A(S[E]);if(D<=i)return E;const U=A(S[I]);if(D>=U)return I;for(;E<=I;){const R=Math.floor((E+I)/2),$=A(S[R]),q=Math.abs($-D);if(q<P&&(P=q,m=R),$<D)E=R+1;else if($>D)I=R-1;else return R}return m>0&&Math.abs(A(S[m-1])-D)<P&&(m=m-1,P=Math.abs(A(S[m])-D)),m<S.length-1&&Math.abs(A(S[m+1])-D)<P&&(m=m+1),m},_=(S,D)=>{S.sort((A,E)=>A[D]-E[D])},cr=(S,D,A,E)=>{if(S.length<=E)return S;if(A)try{const I=S.map((i,U)=>({originalData:i,index:U,x:i[D],y:i[A]??0}));return lr.LTTB(I,E).map(i=>i.originalData)}catch(I){console.error("LTTB Downsampling failed in worker:",I);const m=Math.ceil(S.length/E);return S.filter((P,i)=>i%m===0)}else{const I=Math.ceil(S.length/E);return S.filter((m,P)=>P%I===0)}};self.onmessage=S=>{if(S.data.type==="PROCESS_DATA"){const{activeRuns:D,xAxisKey:A,selectedMetricKeys:E,downsampleThreshold:I}=S.data.payload;try{if(D.length===0){self.postMessage({type:"DATA_READY",payload:{labels:[],datasets:{},fullDataForDetails:[]}});return}D.forEach(h=>{h.performanceLogs&&_(h.performanceLogs,A)});const m=h=>{if(!h.performanceLogs||h.performanceLogs.length===0)return-1/0;const L=h.performanceLogs[h.performanceLogs.length-1][A];return typeof L=="number"&&!isNaN(L)?L:-1/0},P=D.reduce((h,b)=>m(h)>m(b)?h:b),i=D.filter(h=>h.id!==P.id),U=new Map;i.forEach(h=>{U.set(h.id,m(h))});const R=[];P.performanceLogs.forEach(h=>{const b={TIMESTAMP:h.TIMESTAMP,[A]:h[A]},L=P.id;b[`${L}:TIMESTAMP`]=h.TIMESTAMP,P.availableMetrics.forEach(d=>{const k=d.key;h[k]!==void 0&&(b[`${L}:${k}`]=h[k])}),b[`${L}:TIMESTAMP`]=h.TIMESTAMP,b[`${L}:SPLINE.DISTANCE`]=h["SPLINE.DISTANCE"],b[`${L}:BURST_LOGGING_STATUS`]=h.BURST_LOGGING_STATUS;const O=h[A];isNaN(O)||(i.forEach(d=>{if(!d.performanceLogs||d.performanceLogs.length===0)return;const k=U.get(d.id)??-1/0;if(O>k)return;const K=ur(d.performanceLogs,O,N=>N[A]??0);if(K!==-1){const N=d.performanceLogs[K],Y=d.id;d.availableMetrics.forEach(H=>{const V=H.key;N[V]!==void 0&&(b[`${Y}:${V}`]=N[V])}),N.BURST_LOGGING_STATUS!==void 0&&(b[`${Y}:BURST_LOGGING_STATUS`]=N.BURST_LOGGING_STATUS),N.TIMESTAMP!==void 0&&(b[`${Y}:TIMESTAMP`]=N.TIMESTAMP)}}),R.push(b))}),_(R,A);let $;E.length>0&&($=`${P.id}:${E[0]}`);const q=cr(R,A,$,I),F=q.map(h=>h[A]),C={};D.forEach(h=>{E.forEach(b=>{const L=`${h.id}:${b}`;C[L]=q.map(O=>{const d=O[L];return{x:O[A],y:typeof d=="number"?d:null}})})}),self.postMessage({type:"DATA_READY",payload:{labels:F,datasets:C,fullDataForDetails:R}})}catch(m){console.error("Error processing chart data in worker:",m),self.postMessage({type:"ERROR",payload:{message:m.message||"Unknown worker error"}})}}}})();
